-- Top 5 Products
SELECT 
    p.product_name,
    SUM(f.sales_amount) AS Total_Sales,
    RANK() OVER (ORDER BY SUM(f.sales_amount) DESC) AS Sales_Rank
FROM fact_sales f
JOIN dim_products p ON f.product_key = p.product_key
GROUP BY product_name
ORDER BY Sales_Rank
LIMIT 5;

-- Top 5 Countries
SELECT 
    c.country,
    SUM(f.sales_amount) AS Total_Sales,
    RANK() OVER (ORDER BY SUM(f.sales_amount) DESC) AS Country_Rank
FROM fact_sales f
JOIN dim_customers c ON f.customer_key = c.customer_key
GROUP BY c.country
ORDER BY Country_Rank
LIMIT 5;

-- Top 5 Categories
SELECT 
    p.category,
    SUM(f.sales_amount) AS Total_Sales,
    RANK() OVER (ORDER BY SUM(f.sales_amount) DESC) AS Category_Rank
FROM fact_sales f
JOIN dim_products p ON f.product_key = p.product_key
GROUP BY p.category
ORDER BY Category_Rank
LIMIT 5;

-- Top 5 Customers
SELECT 
    c.customer_number,
    CONCAT(c.first_name, ' ', c.last_name) AS Customer_Name,
    SUM(f.sales_amount) AS Total_Spent,
    RANK() OVER (ORDER BY SUM(f.sales_amount) DESC) AS Customer_Rank
FROM fact_sales f
JOIN dim_customers c ON f.customer_key = c.customer_key
GROUP BY c.customer_number, c.first_name, c.last_name
ORDER BY Customer_Rank
LIMIT 5;
