-- Basic Sales Metrics
SELECT SUM(sales_amount) AS Total_Sales, SUM(quantity) AS Quantity_Sold FROM fact_sales;

-- Average Sales per Customer
SELECT CONCAT(TRIM(d.first_name), ' ', TRIM(d.last_name)) AS Full_Name, AVG(sales_amount) AS Avg_Sales
FROM fact_sales f
JOIN dim_customers d USING(customer_key)
GROUP BY 1;

-- Total Quantity Sold by Product
SELECT p.product_name, SUM(f.quantity) AS Total_Quantity
FROM fact_sales f
JOIN dim_products p ON f.product_key = p.product_key
GROUP BY p.product_name;

-- Total Sales by Country
SELECT c.country, SUM(f.sales_amount) AS Total_Sales
FROM fact_sales f
JOIN dim_customers c ON f.customer_key = c.customer_key
GROUP BY c.country;
